# 农产品追溯系统 - 综合功能需求清单

## 系统概述
本系统是一个基于Web的土鸡养殖追溯系统，旨在为消费者提供完整的农产品生产过程追溯信息，确保食品安全和质量透明。

## 功能需求表

| 功能/模块名称 | 前端需求 | 后端需求 | 优先级 | 功能描述 |
|--------------|----------|----------|--------|----------|
| **用户认证与授权** | 登录/注册界面、角色切换、权限控制UI | JWT认证、用户管理、角色权限管理API | 高 | 支持消费者、农户、企业、监管部门等不同角色登录，实现分级权限管理 |
| **产品信息管理** | 产品详情展示、基本信息编辑表单 | 产品CRUD API、产品分类管理、产品图片上传 | 高 | 管理农产品基本信息（名称、品种、有机认证、产地等） |
| **二维码扫描与查询** | 扫码界面、查询结果展示、首次查询时间记录 | 二维码生成、产品查询API、查询记录统计 | 高 | 消费者扫码查看产品追溯信息，记录查询时间和次数 |
| **养殖环境监控** | 实时温湿度显示、环境数据图表、监控画面展示 | IoT设备数据接收、环境数据存储、实时数据推送API | 高 | 实时监控养殖环境的温度、湿度等关键指标 |
| **动物活动追踪** | 运动步数展示、活动统计图表、健康状态指示器 | 运动数据采集API、活动数据分析、健康评估算法 | 中 | 通过传感器追踪动物运动情况，评估健康状态 |
| **喂养记录管理** | 喂养记录列表、添加/编辑喂养记录表单、图片上传 | 喂养记录CRUD API、饲料管理、操作员管理 | 高 | 记录每次喂养的时间、饲料类型、操作人员、现场照片 |
| **养殖流程管理** | 时间线展示、流程节点管理、状态更新界面 | 流程节点API、状态变更记录、时间戳管理 | 高 | 管理从进场、身份绑定到出栏的完整养殖流程 |
| **实时监控系统** | 监控视频播放、地理位置显示、监控设备状态 | 视频流处理、地理信息API、设备状态监控 | 中 | 提供养殖场实时视频监控和地理位置信息 |
| **图片画廊管理** | 图片预览、多图展示、图片上传界面 | 图片存储服务、图片压缩、CDN集成 | 中 | 管理养殖过程中的各类照片和证明文件 |
| **数据统计分析** | 统计图表、数据报表、趋势分析界面 | 数据分析API、报表生成、统计算法 | 中 | 提供养殖数据的统计分析和趋势预测 |
| **农户/企业管理** | 农户信息展示、企业资质显示、联系方式管理 | 农户/企业档案API、资质认证管理、信息验证 | 高 | 管理参与养殖的农户和企业信息 |
| **质量检测报告** | 检测报告展示、证书查看、检测历史记录 | 检测数据API、报告生成、证书管理 | 高 | 管理产品质量检测报告和相关证书 |
| **移动端适配** | 响应式设计、触摸交互、移动端优化 | 移动端API优化、推送通知服务 | 高 | 确保在手机端的良好用户体验 |
| **消息通知系统** | 通知列表、消息提醒、推送设置 | 消息推送API、通知模板管理、推送服务集成 | 中 | 向相关人员推送重要信息和异常警报 |
| **数据导出功能** | 导出界面、格式选择、下载管理 | 数据导出API、多格式支持、批量导出 | 低 | 支持将追溯数据导出为Excel、PDF等格式 |
| **系统配置管理** | 配置界面、参数设置、系统维护 | 配置管理API、参数验证、系统监控 | 低 | 管理系统参数配置和维护功能 |
| **区块链集成** | 区块链状态显示、哈希值展示、验证界面 | 区块链API、数据上链、哈希验证 | 低 | 将关键数据上链确保数据不可篡改 |
| **多语言支持** | 语言切换界面、本地化内容 | 多语言API、内容翻译管理 | 低 | 支持中英文等多语言界面 |

## 核心数据模型需求

### 1. 产品模型 (Product)
- 产品ID (product_id)
- 产品名称 (name)
- 产品品种 (variety)
- 有机认证 (organic_certified)
- 国产/进口 (origin_type)
- 二维码 (qr_code)
- 创建时间 (created_at)
- 更新时间 (updated_at)

### 2. 环境数据模型 (EnvironmentData)
- 记录ID (record_id)
- 产品ID (product_id)
- 温度 (temperature)
- 湿度 (humidity)
- 记录时间 (recorded_at)
- 设备ID (device_id)

### 3. 喂养记录模型 (FeedingRecord)
- 记录ID (record_id)
- 产品ID (product_id)
- 饲料类型 (feed_type)
- 喂养时间 (feeding_time)
- 操作员 (operator_name)
- 图片列表 (images)
- 备注 (notes)

### 4. 流程节点模型 (ProcessNode)
- 节点ID (node_id)
- 产品ID (product_id)
- 节点类型 (node_type) - 进场/身份绑定/出栏
- 执行时间 (execution_time)
- 状态 (status)
- 图片数量 (image_count)
- 描述 (description)

### 5. 用户模型 (User)
- 用户ID (user_id)
- 用户名 (username)
- 用户类型 (user_type) - 消费者/农户/企业/监管部门
- 联系方式 (contact_info)
- 权限级别 (permission_level)
- 认证状态 (verified_status)

### 6. 查询记录模型 (QueryRecord)
- 查询ID (query_id)
- 产品ID (product_id)
- 查询时间 (query_time)
- 查询IP (query_ip)
- 用户标识 (user_identifier)
- 是否首次查询 (is_first_query)

### 7. 农户/企业模型 (FarmEntity)
- 实体ID (entity_id)
- 实体类型 (entity_type) - 农户/企业
- 名称 (name)
- 地址 (address)
- 联系方式 (contact)
- 资质证书 (certificates)
- 认证状态 (certification_status)

## 关键API接口需求

### 产品相关API
- `GET /api/products/{qrcode}` - 根据二维码获取产品信息
- `POST /api/products` - 创建新产品
- `PUT /api/products/{id}` - 更新产品信息
- `DELETE /api/products/{id}` - 删除产品

### 环境监控API
- `GET /api/environment/{productId}` - 获取实时环境数据
- `GET /api/environment/{productId}/history` - 获取历史环境数据
- `POST /api/environment` - 上报环境数据

### 喂养记录API
- `GET /api/feeding/{productId}` - 获取喂养记录列表
- `POST /api/feeding` - 添加喂养记录
- `PUT /api/feeding/{id}` - 更新喂养记录
- `DELETE /api/feeding/{id}` - 删除喂养记录

### 流程管理API
- `GET /api/timeline/{productId}` - 获取养殖流程时间线
- `POST /api/timeline` - 添加流程节点
- `PUT /api/timeline/{id}` - 更新流程节点

### 文件管理API
- `POST /api/upload` - 上传图片文件
- `GET /api/images/{imageId}` - 获取图片
- `DELETE /api/images/{imageId}` - 删除图片

### 用户认证API
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/logout` - 用户登出
- `GET /api/auth/profile` - 获取用户信息

### 实时数据推送
- WebSocket连接: `ws://domain/api/realtime/{productId}`
- 推送环境数据更新
- 推送流程状态变更
- 推送异常警报

## 技术架构建议

### 前端技术栈
- HTML5 + CSS3 + JavaScript (ES6+)
- 响应式设计框架
- 图表库 (Chart.js/ECharts)
- 二维码扫描库
- PWA支持

### 后端技术栈
- Node.js + Express / Python + Django / Java + Spring Boot
- 关系型数据库 (MySQL/PostgreSQL)
- Redis缓存
- 文件存储 (阿里云OSS/AWS S3)
- WebSocket支持

### 部署架构
- 容器化部署 (Docker)
- 负载均衡
- CDN加速
- 监控告警系统

## 开发优先级建议

### 第一阶段 (核心功能)
1. 用户认证与授权
2. 产品信息管理
3. 二维码扫描与查询
4. 基础的喂养记录管理

### 第二阶段 (追溯功能)
1. 养殖环境监控
2. 养殖流程管理
3. 图片画廊管理
4. 农户/企业管理

### 第三阶段 (增强功能)
1. 动物活动追踪
2. 数据统计分析
3. 实时监控系统
4. 消息通知系统

### 第四阶段 (扩展功能)
1. 质量检测报告
2. 数据导出功能
3. 系统配置管理
4. 区块链集成
5. 多语言支持

---

*本功能清单基于现有前端代码分析生成，为农产品追溯系统的完整开发提供指导。*
